<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>はとあげマーケット - メール送信</title>
    <meta name="description" content="美味しいはとあげを出来たてで提供する架空のコンビニ公式サイトのメールマガジンを登録サイト">
    <meta name="keywords" content="わたあめえ, はとあげ, Fortnite, Discord, はと">
    <meta name="author" content="はとあげマーケット">
    <link rel="canonical" href="https://hatoage.wata777.f5.si/">
    <link rel="icon" href="logo.png" type="image/png">
    <link rel="stylesheet" href="/style.css">

    <!-- Atatus: 不要なtype属性と<font>を削除 -->
    <script src="https://dmc1acwvwny3.cloudfront.net/atatus-spa.js"></script>
    <script>
        atatus.config('3b8a17d616d24583a30d41294ed01917').install();
    </script>
    <script src="/script.js"></script>

    <!-- OGP -->
    <meta property="og:title" content="はとあげマーケット">
    <meta property="og:description" content="美味しいはとあげを出来たてで提供する架空のコンビニ公式サイトのメールマガジンを登録サイト">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://hatoage.wata.f5.si/">
    <meta property="og:image" content="https://hatoage.wata.f5.si/assets/logo.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="はとあげマーケットメール">
    <meta name="twitter:description" content="美味しいはとあげを出来たてで提供する架空のコンビニ公式サイトのメールマガジン登録サイト">
    <meta name="twitter:image" content="https://hatoage.wata777.f5.si/assets/logo.png">

    <style>
body {
  font-family: system-ui, sans-serif;
  background: #f4f4f4;
  padding: 24px;
}

section {
  background: #fff;
  padding: 16px;
  margin-bottom: 16px;
  border-radius: 8px;
}

label {
  display: block;
  margin-top: 12px;
}

input, select, button {
  width: 100%;
  margin-top: 6px;
}
    </style>
</head> <!-- ← 閉じタグが抜けていたのを追加 -->
<body>
<%- include("partials/header") %>
<main>
   <% if (state === "input") { %>
<section>
  <h2>操作</h2>
  <form method="POST" action="/mail">
    <input type="hidden" name="step" value="request">

    <label>操作</label>
    <select name="action" required>
      <option value="list">一覧</option>
      <option value="add">追加</option>
      <option value="delete">削除</option>
    </select>

    <label>メール</label>
    <input name="email" type="email" required>

    <button>OTP送信</button>
  </form>
</section>
<% } %>

<% if (state === "otp") { %>
<section>
  <h2>認証</h2>
  <form method="POST" action="/mail">
    <input type="hidden" name="step" value="verify">
    <input type="hidden" name="email" value="<%= email %>">
    <input type="hidden" name="action" value="<%= action %>">

    <label>OTP</label>
    <input name="otp" pattern="\d{6}" required>

    <button>実行</button>
  </form>
</section>
<% } %>

<% if (state === "done") { %>
<section>
  <h2>完了</h2>
  <pre><%= JSON.stringify(result, null, 2) %></pre>
  <a href="/mail">戻る</a>
</section>
<% } %>

<% if (state === "error") { %>
<section>
  <h2>エラー</h2>
  <p><%= error %></p>
  <a href="/mail">戻る</a>
</section>
<% } %>

<a href="/" id="btn" class="btn-link">ホーム</a>
</main>

<%- include("partials/footer") %>
</body>
</html>
